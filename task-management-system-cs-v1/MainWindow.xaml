<Window x:Class="task_management_system_cs_v1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:task_management_system_cs_v1"
        mc:Ignorable="d"
        Title="Task Management System" Height="600" Width="1000" WindowStartupLocation="CenterScreen">

    <!-- Application Resources -->
    <Window.Resources>
        <!-- Converter for toggling between showing completed/pending tasks -->
        <local:BoolToViewTextConverter x:Key="BoolToViewTextConverter"/>
    </Window.Resources>

    <Grid>
        <!-- Main layout with two columns: tasks on left, command history on right -->
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <!-- Main content column -->
            <ColumnDefinition Width="Auto"/>
            <!-- Command history column -->
        </Grid.ColumnDefinitions>

        <!-- Main Content Area -->
        <Grid Grid.Column="0" Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Add Task Section -->
                <RowDefinition Height="Auto"/>
                <!-- Search Section -->
                <RowDefinition Height="*"/>
                <!-- Tasks List -->
            </Grid.RowDefinitions>

            <!-- Add New Task Section -->
            <GroupBox Grid.Row="0" Header="Add New Task" Margin="0,0,0,10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Task Description Input -->
                    <Label Content="Description:" Grid.Column="0" Margin="5"/>
                    <TextBox Grid.Column="1" Text="{Binding NewTaskDescription, UpdateSourceTrigger=PropertyChanged}" Margin="5"/>

                    <!-- Due Date Picker -->
                    <Label Content="Due Date:" Grid.Column="2" Margin="5"/>
                    <DatePicker Grid.Column="3" SelectedDate="{Binding NewTaskDueDate}" Margin="5" Width="120"/>

                    <!-- Priority Selection -->
                    <Label Content="Priority:" Grid.Column="4" Margin="5"/>
                    <ComboBox Grid.Column="5" SelectedValue="{Binding NewTaskPriority}" Margin="5" Width="100">
                        <ComboBoxItem Content="High"/>
                        <ComboBoxItem Content="Medium" IsSelected="True"/>
                        <ComboBoxItem Content="Low"/>
                    </ComboBox>

                    <!-- Add Task Button -->
                    <Button Grid.Column="6" Content="Add Task" Command="{Binding AddTaskCommand}" Margin="5" Padding="10,5"/>
                </Grid>
            </GroupBox>

            <!-- Search and Filter Section -->
            <GroupBox Grid.Row="1" Header="Search and Filter" Margin="0,0,0,10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <!-- Search box -->
                        <ColumnDefinition Width="Auto"/>
                        <!-- Search button -->
                        <ColumnDefinition Width="Auto"/>
                        <!-- Toggle view button -->
                    </Grid.ColumnDefinitions>

                    <!-- Search Text Box -->
                    <TextBox Grid.Column="0" 
                             Text="{Binding SearchTerm, UpdateSourceTrigger=PropertyChanged}" 
                             Margin="5" Padding="5">
                        <TextBox.InputBindings>
                            <KeyBinding Key="Enter" Command="{Binding SearchCommand}"/>
                        </TextBox.InputBindings>
                    </TextBox>

                    <!-- Search Button -->
                    <Button Grid.Column="1" 
                            Content="Search" 
                            Command="{Binding SearchCommand}" 
                            Margin="5" Padding="10,5"/>

                    <!-- Toggle View Button -->
                    <Button Grid.Column="2" 
                            Content="{Binding ShowCompletedTasks, Converter={StaticResource BoolToViewTextConverter}}" 
                            Command="{Binding ToggleViewCommand}" 
                            Margin="5" Padding="10,5"/>
                </Grid>
            </GroupBox>

            <!-- Tasks List Display -->
            <GroupBox Grid.Row="2" Header="Tasks">
                <ListView ItemsSource="{Binding Tasks}" Margin="5">
                    <ListView.View>
                        <GridView>
                            <!-- Completed Checkbox Column -->
                            <GridViewColumn Header="Completed" Width="80">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsCompleted}" 
                                                  Command="{Binding DataContext.ToggleTaskStatusCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                                  CommandParameter="{Binding}" 
                                                  HorizontalAlignment="Center"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>

                            <!-- Task Description Column -->
                            <GridViewColumn Header="Description" 
                                           DisplayMemberBinding="{Binding Description}" 
                                           Width="300"/>

                            <!-- Due Date Column -->
                            <GridViewColumn Header="Due Date" 
                                           DisplayMemberBinding="{Binding DueDate, StringFormat=yyyy-MM-dd}" 
                                           Width="100"/>

                            <!-- Priority Column -->
                            <GridViewColumn Header="Priority" 
                                           DisplayMemberBinding="{Binding Priority}" 
                                           Width="80"/>

                            <!-- Delete Action Column -->
                            <GridViewColumn Header="Actions" Width="100">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="Delete" 
                                                Command="{Binding DataContext.DeleteTaskCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                                CommandParameter="{Binding}" 
                                                Margin="2" Padding="5,2"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                        </GridView>
                    </ListView.View>
                </ListView>
            </GroupBox>
        </Grid>

        <!-- Command History Panel -->
        <GroupBox Grid.Column="1" Header="Command History" Width="250" Margin="10">
            <ListView ItemsSource="{Binding CommandHistory}" Margin="5">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding}" TextWrapping="Wrap"/>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </GroupBox>
    </Grid>
</Window>